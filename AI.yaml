/***
 * Clash Verge Rev / Mihomo Party ä¼˜åŒ–è„šæœ¬
 * åŸä½œè€…: dahaha-365 (YaNet)
 * Githubï¼šhttps://github.com/dahaha-365/YaNet
 */

// --- 1. é™æ€é…ç½®åŒºåŸŸ ---
const enable = true;

const ruleOptions = {
  apple: true,
  microsoft: true,
  github: true,
  google: true,
  openai: true,
  spotify: true,
  youtube: true,
  bahamut: true,
  netflix: true,
  tiktok: true,
  disney: true,
  pixiv: true,
  hbo: true,
  'media-cn@!cn': true,
  biliintl: true,
  tvb: true,
  hulu: true,
  primevideo: true,
  telegram: true,
  line: true,
  whatsapp: true,
  games: true,
  japan: true,
  ads: false,
};

const skipIps = ['10.0.0.0/8', '172.16.0.0/12', '192.168.0.0/16', '169.254.0.0/16', '127.0.0.0/8', 'FC00::/7', 'FE80::/10', '::1/128'];

const rules = [
  'RULE-SET,applications,ä¸‹è½½è½¯ä»¶',
  'PROCESS-NAME,SunloginClient,DIRECT', 'PROCESS-NAME,SunloginClient.exe,DIRECT',
  'PROCESS-NAME,AnyDesk,DIRECT', 'PROCESS-NAME,AnyDesk.exe,DIRECT',
  'PROCESS-NAME,èŠ‚ç‚¹å°å®,DIRECT', 'PROCESS-NAME,nblink.exe,DIRECT',
  'PROCESS-NAME,NodeBabyLinkBackup,DIRECT', 'PROCESS-NAME,NodeBabyLinkClient,DIRECT',
  'PROCESS-NAME,NodeBabyLinkRfile,DIRECT', 'PROCESS-NAME,NodeBabyLinkBackup.exe,DIRECT',
  'PROCESS-NAME,NodeBabyLinkClient.exe,DIRECT', 'PROCESS-NAME,NodeBabyLinkDevice.exe,DIRECT',
  'PROCESS-NAME,NodeBabyLinkOwjdxb.exe,DIRECT', 'PROCESS-NAME,NodeBabyLinkRfile.exe,DIRECT',
  'PROCESS-NAME,NodeBabyLinkService.exe,DIRECT',
  'DOMAIN-SUFFIX,iepose.com,DIRECT', 'DOMAIN-SUFFIX,ionewu.com,DIRECT',
];

// åœ°åŒºå®šä¹‰
const regionDefinitions = [{
    name: 'HKé¦™æ¸¯',
    regex: /æ¸¯|ğŸ‡­ğŸ‡°|hk|hongkong|hong kong/i,
    icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Hong_Kong.png'
  },
  { name: 'USç¾å›½', regex: /(?!.*aus)(?=.*(ç¾|ğŸ‡ºğŸ‡¸|us(?!t)|usa|american|united states)).*/i, icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/United_States.png' },
  { name: 'JPæ—¥æœ¬', regex: /æ—¥æœ¬|ğŸ‡¯ğŸ‡µ|jp|japan/i, icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Japan.png' },
  { name: 'KRéŸ©å›½', regex: /éŸ©|ğŸ‡°ğŸ‡·|kr|korea/i, icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Korea.png' },
  { name: 'SGæ–°åŠ å¡', regex: /æ–°åŠ å¡|ğŸ‡¸ğŸ‡¬|sg|singapore/i, icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Singapore.png' },
  { name: 'CNä¸­å›½å¤§é™†', regex: /ä¸­å›½|ğŸ‡¨ğŸ‡³|cn|china/i, icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/China_Map.png' },
  { name: 'TWå°æ¹¾çœ', regex: /å°æ¹¾|ğŸ‡¹ğŸ‡¼|tw|taiwan|tai wan/i, icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/China.png' },
  { name: 'GBè‹±å›½', regex: /è‹±|ğŸ‡¬ğŸ‡§|uk|united kingdom|great britain/i, icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/United_Kingdom.png' },
  { name: 'DEå¾·å›½', regex: /å¾·å›½|ğŸ‡©ğŸ‡ª|de|germany/i, icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Germany.png' },
  { name: 'MYé©¬æ¥è¥¿äºš', regex: /é©¬æ¥|ğŸ‡²ğŸ‡¾|my|malaysia/i, icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Malaysia.png' },
  { name: 'TKåœŸè€³å…¶', regex: /åœŸè€³å…¶|ğŸ‡¹ğŸ‡·|tk|turkey/i, icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Turkey.png' },
  { name: 'CAåŠ æ‹¿å¤§', regex: /åŠ æ‹¿å¤§|ğŸ‡¨ğŸ‡¦|ca|canada/i, icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Canada.png' },
  { name: 'AUæ¾³å¤§åˆ©äºš', regex: /æ¾³å¤§åˆ©äºš|ğŸ‡¦ğŸ‡º|au|australia|sydney/i, icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Australia.png' },
];

const excludeHighPercentage = true;
const globalRatioLimit = 2;

const chinaDNS = ['119.29.29.29', '223.5.5.5'];
const foreignDNS = ['https://doh.pub/dns-query', 'https://dns.alidns.com/dns-query'];
const dnsConfig = {
  enable: true,
  listen: ':1053',
  ipv6: true,
  'prefer-h3': true,
  'use-hosts': true,
  'use-system-hosts': true,
  'respect-rules': true,
  'enhanced-mode': 'redir-host',
  nameserver: foreignDNS,
  fallback: chinaDNS,
  'fallback-filter': { geoip: true },
  'proxy-server-nameserver': foreignDNS,
  'nameserver-policy': {
    'geosite:private': 'system',
    'geosite:tld-cn,cn,steam@cn,category-games@cn,microsoft@cn,apple@cn': chinaDNS,
  },
};

const ruleProviderCommon = { type: 'http', format: 'yaml', interval: 86400 };
const groupBaseOption = {
  interval: 300,
  timeout: 3000,
  url: 'http://cp.cloudflare.com/generate_204',
  lazy: true,
  'max-failed-times': 3,
  hidden: false,
};

const ruleProviders = {
  applications: {
    ...ruleProviderCommon,
    behavior: 'classical',
    format: 'text',
    url: 'https://github.com/DustinWin/ruleset_geodata/raw/refs/heads/mihomo-ruleset/applications.list',
    path: './ruleset/DustinWin/applications.list',
  }
};

const multiplierRegex = /(?<=[xXâœ•âœ–â¨‰å€ç‡])([1-9]+(\.\d+)*|0{1}\.\d+)(?=[xXâœ•âœ–â¨‰å€ç‡])*/i;

// --- 2. æœåŠ¡è§„åˆ™æ•°æ®ç»“æ„ï¼ˆå®Œæ•´ç‰ˆï¼‰---
const serviceConfigs = [
  { key: 'openai', name: 'å›½å¤–AI', icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/ChatGPT.png', url: 'https://chat.openai.com/cdn-cgi/trace', rules: ['GEOSITE,jetbrains-ai,å›½å¤–AI', 'GEOSITE,category-ai-!cn,å›½å¤–AI', 'GEOSITE,category-ai-chat-!cn,å›½å¤–AI', 'DOMAIN-SUFFIX,meta.ai,å›½å¤–AI', 'DOMAIN-SUFFIX,meta.com,å›½å¤–AI'] },
  { key: 'youtube', name: 'YouTube', icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/YouTube.png', url: 'https://www.youtube.com/s/desktop/494dd881/img/favicon.ico', rules: ['GEOSITE,youtube,YouTube'] },
  { key: 'media-cn@!cn', name: 'æ¸¯æ¾³å°åª’ä½“', icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/TVB.png', url: 'https://viu.tv/', rules: ['GEOSITE,tvb,æ¸¯æ¾³å°åª’ä½“', 'GEOSITE,hkt,æ¸¯æ¾³å°åª’ä½“', 'GEOSITE,hkopentv,æ¸¯æ¾³å°åª’ä½“', 'RULE-SET,hk-media,æ¸¯æ¾³å°åª’ä½“'],
    provider: { key: 'hk-media', url: 'https://ruleset.skk.moe/List/non_ip/stream_hk.conf', path: './ruleset/ruleset.skk.moe/stream_hk.conf', format: 'text', behavior: 'classical' } },
  { key: 'biliintl', name: 'å“”å“©å“”å“©ä¸œå—äºš', icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/bilibili_3.png', url: 'https://www.bilibili.tv/', rules: ['GEOSITE,biliintl,å“”å“©å“”å“©ä¸œå—äºš'] },
  { key: 'bahamut', name: 'å·´å“ˆå§†ç‰¹', icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Bahamut.png', url: 'https://ani.gamer.com.tw/ajax/getdeviceid.php', rules: ['GEOSITE,bahamut,å·´å“ˆå§†ç‰¹'] },
  { key: 'disney', name: 'Disney+', icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Disney+.png', url: 'https://disney.api.edge.bamgrid.com/devices', rules: ['GEOSITE,disney,Disney+'] },
  { key: 'netflix', name: 'NETFLIX', icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Netflix.png', url: 'https://api.fast.com/netflix/speedtest/v2?https=true', rules: ['GEOSITE,netflix,NETFLIX'] },
  { key: 'tiktok', name: 'Tiktok', icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/TikTok.png', url: 'https://www.tiktok.com/', rules: ['GEOSITE,tiktok,Tiktok'] },
  { key: 'spotify', name: 'Spotify', icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Spotify.png', url: 'http://spclient.wg.spotify.com/signup/public/v1/account', rules: ['GEOSITE,spotify,Spotify'] },
  { key: 'pixiv', name: 'Pixiv', icon: 'https://play-lh.googleusercontent.com/8pFuLOHF62ADcN0ISUAyEueA5G8IF49mX_6Az6pQNtokNVHxIVbS1L2NM62H-k02rLM=w240-h480-rw', url: 'http://spclient.wg.spotify.com/signup/public/v1/account', rules: ['GEOSITE,pixiv,Pixiv'] },
  { key: 'hbo', name: 'HBO', icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/HBO.png', url: 'https://www.hbo.com/favicon.ico', rules: ['GEOSITE,hbo,HBO'] },
  { key: 'primevideo', name: 'Prime Video', icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Prime_Video.png', url: 'https://m.media-amazon.com/images/G/01/digital/video/web/logo-min-remaster.png', rules: ['GEOSITE,primevideo,Prime Video'] },
  { key: 'hulu', name: 'Hulu', icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Hulu.png', url: 'https://auth.hulu.com/v4/web/password/authenticate', rules: ['GEOSITE,hulu,Hulu'] },
  { key: 'telegram', name: 'Telegram', icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Telegram.png', url: 'http://www.telegram.org/img/website_icon.svg', rules: ['GEOIP,telegram,Telegram'] },
  { key: 'whatsapp', name: 'WhatsApp', icon: 'https://static.whatsapp.net/rsrc.php/v3/yP/r/rYZqPCBaG70.png', url: 'https://web.whatsapp.com/data/manifest.json', rules: ['GEOSITE,whatsapp,WhatsApp'] },
  { key: 'line', name: 'Line', icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Line.png', url: 'https://line.me/page-data/app-data.json', rules: ['GEOSITE,line,Line'] },
  { key: 'games', name: 'æ¸¸æˆä¸“ç”¨', icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Game.png', rules: ['GEOSITE,category-games@cn,å›½å†…ç½‘ç«™', 'GEOSITE,category-games,æ¸¸æˆä¸“ç”¨'] },
  { key: 'apple', name: 'è‹¹æœæœåŠ¡', icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Apple_2.png', url: 'http://www.apple.com/library/test/success.html', rules: ['GEOSITE,apple-cn,è‹¹æœæœåŠ¡'] },
  { key: 'google', name: 'è°·æ­ŒæœåŠ¡', icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Google_Search.png', url: 'http://www.google.com/generate_204', rules: ['GEOSITE,google,è°·æ­ŒæœåŠ¡'] },
  { key: 'github', name: 'Github', icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/GitHub.png', url: 'https://github.com/robots.txt', rules: ['GEOSITE,github,Github'] },
  { key: 'microsoft', name: 'å¾®è½¯æœåŠ¡', icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Microsoft.png', url: 'http://www.msftconnecttest.com/connecttest.txt', rules: ['GEOSITE,microsoft@cn,å›½å†…ç½‘ç«™', 'GEOSITE,microsoft,å¾®è½¯æœåŠ¡'] },
  { key: 'japan', name: 'æ—¥æœ¬ç½‘ç«™', icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/JP.png', url: 'https://r.r10s.jp/com/img/home/logo/touch.png', rules: ['RULE-SET,category-bank-jp,æ—¥æœ¬ç½‘ç«™', 'GEOIP,jp,æ—¥æœ¬ç½‘ç«™,no-resolve'],
    provider: { key: 'category-bank-jp', url: 'https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/category-bank-jp.mrs', path: './ruleset/MetaCubeX/category-bank-jp.mrs', format: 'mrs', behavior: 'domain' } },

  // Hanimeï¼ˆçº¢è‰²Hå­—æ¯ + é»‘åº•ï¼‰
  { 
    key: 'hanime', 
    name: 'Hanime', 
    icon: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDgiIGhlaWdodD0iNDgiIHZpZXdCb3g9IjAgMCA0OCA0OCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjQ4IiBoZWlnaHQ9IjQ4IiBmaWxsPSIjMDAwMDAwIi8+Cjx0ZXh0IHg9IjI0IiB5PSI0MCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjM2IiBmaWxsPSIjRkYwMDAwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5IPC90ZXh0Pgo8L3N2Zz4=',  
    url: 'https://hanime1.me/', 
    rules: ['DOMAIN-SUFFIX,hanime1.me,Hanime', 'DOMAIN-SUFFIX,hanime.tv,Hanime'] 
  },

  // Hï¼ˆé»‘å­—PH + æ£•æ©™åº•ï¼ŒPornhubé£æ ¼ï¼‰
  { 
    key: 'adult-sites', 
    name: 'H', 
    icon: 'https://raw.githubusercontent.com/Orz-3/mini/master/Color/Pornhub.png',  // å®Œç¾åŒ¹é…ï¼šé»‘PH + æ©™æ£•åº•ï¼Œæ–¹å½¢å›¾æ ‡ï¼Œå¸¸ç”¨äºè§„åˆ™é›†
    url: 'http://cp.cloudflare.com/generate_204', 
    rules: [
      'DOMAIN-SUFFIX,sehuatang.net,H',
      'DOMAIN-SUFFIX,chaturbate.com,H',
      'DOMAIN-SUFFIX,stripchat.com,H',
      'DOMAIN-SUFFIX,xsijishe.com,H',
      'DOMAIN-SUFFIX,pornhub.com,H',
      'DOMAIN-SUFFIX,cn.pornhub.com,H'
    ] 
  }
];

// --- 3. ä¸»å…¥å£ ---
function main(config) {
  if (!enable) return config;

  const proxies = config?.proxies || [];
  const proxyCount = proxies.length;
  const proxyProviderCount = Object.keys(config['proxy-providers'] || {}).length;

  if (proxyCount === 0 && proxyProviderCount === 0) {
    throw new Error('é…ç½®æ–‡ä»¶ä¸­æœªæ‰¾åˆ°ä»»ä½•ä»£ç†');
  }

  config['allow-lan'] = true;
  config['bind-address'] = '*';
  config['mode'] = 'rule';
  config['dns'] = dnsConfig;
  config['profile'] = { 'store-selected': true, 'store-fake-ip': true };
  config['unified-delay'] = true;
  config['tcp-concurrent'] = true;
  config['keep-alive-interval'] = 1800;
  config['find-process-mode'] = 'strict';
  config['geodata-mode'] = true;
  config['geodata-loader'] = 'memconservative';
  config['geo-auto-update'] = true;
  config['geo-update-interval'] = 24;

  config['sniffer'] = {
    enable: true,
    'force-dns-mapping': true,
    'parse-pure-ip': false,
    'override-destination': true,
    sniff: { TLS: { ports: [443, 8443] }, HTTP: { ports: [80, '8080-8880'] }, QUIC: { ports: [443, 8443] } },
    'skip-src-address': skipIps,
    'skip-dst-address': skipIps,
    'force-domain': ['+.google.com', '+.googleapis.com', '+.googleusercontent.com', '+.youtube.com', '+.facebook.com', '+.messenger.com', '+.fbcdn.net', 'fbcdn-a.akamaihd.net'],
    'skip-domain': ['Mijia Cloud', '+.oray.com'],
  };

  config['ntp'] = { enable: true, 'write-to-system': false, server: 'cn.ntp.org.cn' };
  config['tun'] = { stack: 'mixed', 'exclude-interface': ['NodeBabyLink'], 'route-exclude-address': skipIps };
  config['geox-url'] = {
    geoip: 'https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geoip-lite.dat',
    geosite: 'https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geosite.dat',
    mmdb: 'https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/country-lite.mmdb',
    asn: 'https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/GeoLite2-ASN.mmdb',
  };

  config.proxies.push({ name: 'ç›´è¿', type: 'direct', udp: true });

  const regionGroups = {};
  regionDefinitions.forEach(r => regionGroups[r.name] = { ...r, proxies: [] });
  const otherProxies = [];

  for (let i = 0; i < proxyCount; i++) {
    const proxy = proxies[i];
    const name = proxy.name;
    let matched = false;

    if (excludeHighPercentage) {
      const match = multiplierRegex.exec(name);
      if (match && parseFloat(match[1]) > globalRatioLimit) continue;
    }

    for (const region of regionDefinitions) {
      if (region.regex.test(name)) {
        regionGroups[region.name].proxies.push(name);
        matched = true;
        break;
      }
    }

    if (!matched) otherProxies.push(name);
  }

  const generatedRegionGroups = [];
  const regionGroupNames = [];
  regionDefinitions.forEach(r => {
    const groupData = regionGroups[r.name];
    if (groupData.proxies.length > 0) {
      const group = { ...groupBaseOption, name: r.name, type: 'url-test', tolerance: 50, icon: r.icon, proxies: groupData.proxies };
      generatedRegionGroups.push(group);
      regionGroupNames.push(r.name);
    }
  });

  if (otherProxies.length > 0) {
    generatedRegionGroups.push({ ...groupBaseOption, name: 'å…¶ä»–èŠ‚ç‚¹', type: 'select', proxies: otherProxies, icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/World_Map.png' });
  }

  const functionalGroups = [];

  functionalGroups.push({
    ...groupBaseOption,
    name: 'é»˜è®¤èŠ‚ç‚¹',
    type: 'select',
    proxies: [...regionGroupNames, 'å…¶ä»–èŠ‚ç‚¹', 'ç›´è¿'].filter(n => n !== 'å…¶ä»–èŠ‚ç‚¹' || otherProxies.length > 0),
    icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Proxy.png',
  });

  serviceConfigs.forEach(svc => {
    const enabled = ruleOptions[svc.key] !== false || ['hanime', 'adult-sites'].includes(svc.key);
    if (enabled) {
      rules.push(...svc.rules);
      if (svc.provider) {
        ruleProviders[svc.provider.key] = { ...ruleProviderCommon, behavior: svc.provider.behavior, format: svc.provider.format, url: svc.provider.url, path: svc.provider.path };
      }

      let groupProxies = ['é»˜è®¤èŠ‚ç‚¹', ...regionGroupNames, 'ç›´è¿'];

      if (svc.key === 'hanime') {
        groupProxies = ['é»˜è®¤èŠ‚ç‚¹', 'HKé¦™æ¸¯', 'TWå°æ¹¾çœ', 'SGæ–°åŠ å¡', 'ç›´è¿'].filter(p => p === 'é»˜è®¤èŠ‚ç‚¹' || p === 'ç›´è¿' || regionGroupNames.includes(p));
      } else if (svc.key === 'adult-sites') {
        groupProxies = ['é»˜è®¤èŠ‚ç‚¹', 'HKé¦™æ¸¯', 'TWå°æ¹¾çœ', 'SGæ–°åŠ å¡', 'JPæ—¥æœ¬', 'ç›´è¿'].filter(p => p === 'é»˜è®¤èŠ‚ç‚¹' || p === 'ç›´è¿' || regionGroupNames.includes(p));
      } else if (svc.key === 'biliintl' || svc.key === 'bahamut') {
        groupProxies = ['é»˜è®¤èŠ‚ç‚¹', 'ç›´è¿', ...regionGroupNames];
      }

      functionalGroups.push({
        ...groupBaseOption,
        name: svc.name,
        type: 'select',
        proxies: groupProxies,
        url: svc.url || 'http://cp.cloudflare.com/generate_204',
        icon: svc.icon
      });
    }
  });

  rules.push(
    'GEOSITE,private,DIRECT',
    'GEOIP,private,DIRECT,no-resolve',
    'GEOSITE,cn,å›½å†…ç½‘ç«™',
    'GEOIP,cn,å›½å†…ç½‘ç«™,no-resolve',
    'MATCH,å…¶ä»–å¤–ç½‘'
  );

  functionalGroups.push(
    { ...groupBaseOption, name: 'ä¸‹è½½è½¯ä»¶', type: 'select', proxies: ['ç›´è¿', 'REJECT', 'é»˜è®¤èŠ‚ç‚¹', 'å›½å†…ç½‘ç«™', ...regionGroupNames], icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Download.png' },
    { ...groupBaseOption, name: 'å…¶ä»–å¤–ç½‘', type: 'select', proxies: ['é»˜è®¤èŠ‚ç‚¹', 'å›½å†…ç½‘ç«™', ...regionGroupNames], icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Streaming!CN.png' },
    { ...groupBaseOption, name: 'å›½å†…ç½‘ç«™', type: 'select', proxies: ['ç›´è¿', 'é»˜è®¤èŠ‚ç‚¹', ...regionGroupNames], url: 'http://wifi.vivo.com.cn/generate_204', icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/StreamingCN.png' }
  );

  config['proxy-groups'] = [
    { ...groupBaseOption, name: 'è‡ªåŠ¨é€‰æ‹©', type: 'url-test', tolerance: 50, lazy: true, proxies: [...regionGroupNames, 'å…¶ä»–èŠ‚ç‚¹'].filter(n => n !== 'å…¶ä»–èŠ‚ç‚¹' || otherProxies.length > 0), icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Auto.png', interval: 1200 },
    { ...groupBaseOption, name: 'é»˜è®¤èŠ‚ç‚¹', type: 'select', proxies: ['è‡ªåŠ¨é€‰æ‹©', ...regionGroupNames, 'å…¶ä»–èŠ‚ç‚¹', 'ç›´è¿'].filter(n => n !== 'å…¶ä»–èŠ‚ç‚¹' || otherProxies.length > 0), icon: 'https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Proxy.png' },
    ...functionalGroups.slice(1),
    ...generatedRegionGroups
  ];

  config['rules'] = rules;
  config['rule-providers'] = ruleProviders;

  return config;
}